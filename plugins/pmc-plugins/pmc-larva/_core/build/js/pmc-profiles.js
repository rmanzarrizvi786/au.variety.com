!function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);class i{constructor(e){this.el=e,this.selectEl=e.querySelector(".js-SelectNav-select"),e.classList.contains("js-SelectNav-redirect")&&this.selectEl.addEventListener("change",this.onChange.bind(this))}onChange(){const e=this.selectEl.options[this.selectEl.selectedIndex].dataset.selectUrl;e&&(window.location.href=e)}}class s{constructor(e){this.el=e,this.el.pmcProfileFilter=this,this.resultContainer=this.el.querySelector(".js-ProfileFilter-results"),this.form=this.el.querySelector(".js-ProfileFilter-form"),this.loadMoreButton=this.el.querySelector(".js-ProfileFilter-loadMore"),this.submitButton=this.form.querySelector(".js-ProfileFilter-submit"),this.onSubmit=this.onSubmit.bind(this),this.el.addEventListener("submit",this.onSubmit),this.onLoadMoreClick=this.onLoadMoreClick.bind(this),this.loadMoreButton.addEventListener("click",this.onLoadMoreClick),this.actionUrl=this.form.getAttribute("action"),this.restUrlBase=window.location.origin+"/wp-json/pmc_core/v1/pmc_core_modules/pmc-profiles",this.queryObject={},this.page=1,this.maxPages=Number,void 0!==window.wp&&(this.template=wp.template("profile-card"))}getCheckedBoxes(){return[...this.form.querySelectorAll('input[type="checkbox"]:checked')]}setQueryObject(e=!1){const t=this.getCheckedBoxes();t.length&&!1===e?this.setQueryObjectFromCheckboxes(t):this.setQueryObjectFromUrl(e),this.queryObject.page=this.page}setQueryObjectFromCheckboxes(e){let t={};e.map(e=>{let r=e.getAttribute("name");r in t||(t[r]=[]),t[r].push(e.getAttribute("value"))}),this.queryObject=Object.assign({},t)}setQueryObjectFromUrl(e){let t={};new URLSearchParams(e).forEach((e,r)=>{let i=e.split(",");r in t||(t[r]=[]),t[r]=[],t[r].push(...i)}),this.queryObject=Object.assign({},t)}createQueryStringFromObject(){return new URLSearchParams(this.queryObject).toString()}getRestEndpointUrl(){return this.restUrlBase+"?"+this.createQueryStringFromObject().replace(/filter_/g,"")}updateActionAttr(){let e="";e+=this.actionUrl,e+="?"+this.createQueryStringFromObject(),this.form.setAttribute("action",e)}onSubmit(e){this.resetPage(),this.setQueryObject(),this.updateActionAttr(),window.fetch&&(e.preventDefault(),this.fetchData().then(e=>{this.maxPages=e.max_pages,this.updateResults(e.profile_list)}))}onLoadMoreClick(){this.increasePage(),this.setQueryObject(window.location.search),this.fetchData().then(e=>{this.maxPages=e.max_pages,this.updateResults(e.profile_list,!1)})}fetchData(){let e=this.getRestEndpointUrl();return fetch(e).then(e=>e.json()).catch(e=>e)}clearResults(){this.resultContainer.innerHTML=""}updateWindowUrl(){const e="?"+this.createQueryStringFromObject();let t=this.queryObject;window.history.pushState&&window.history.pushState(t,"",e)}updateResults(e,t=!0){this.maybeHideLoadMore(this.maxPages),t&&this.clearResults(),this.updateWindowUrl(),void 0!==e[0].name?e.forEach(e=>{let t=this.template(e),r=document.createElement("li");r.innerHTML=t,r.querySelectorAll("a").forEach(t=>{t.setAttribute("href",e.url)}),this.resultContainer.append(r)}):this.resultContainer.innerHTML=e[0]}maybeHideLoadMore(){const e=this.loadMoreButton.classList.contains("a-hidden");this.maxPages>this.page?e&&this.loadMoreButton.classList.remove("a-hidden"):e||this.loadMoreButton.classList.add("a-hidden")}increasePage(){this.page++}resetPage(){this.page=1}}window.addEventListener("load",(function(){[...document.querySelectorAll(".js-SelectNav")].forEach(e=>new i(e)),[...document.querySelectorAll(".js-ProfileFilter")].forEach(e=>e.ProfileFilter=new s(e))}))}]);