/*! 
 * PMC Gallery v3 JavaScript Library 
 */
!function(a){"use strict";var b={TinyMceCaptionId:"",CaptionTextAreaObj:!1,BindMetaBoxCaptionTinyMce:function(){var c;tinyMCE.EditorManager.editors=[],c=a('.attachment-details .setting[data-setting="caption"]'),c.length&&(b.TinyMceCaptionId="pmc-details-caption-"+a(".attachment-details").data("id"),a(c).find("textarea").addClass("mceEditor").attr("id",b.TinyMceCaptionId),b.delegateToolbar=!1,b.AttachTinyMce(b.TinyMceCaptionId))},AttachTinyMce:function(b){var c=!1,d="#"+b;/TEXTAREA|INPUT/i.test(a(d)[0].nodeName)||(c=!0),tinyMCE.execCommand("mceRemoveEditor",!1,b),setTimeout(function(){tinyMCE.PluginManager.add("formatoptions",function(a){["h3"].forEach(function(b){a.addButton("style-"+b,{tooltip:"Toggle "+b,text:b.toUpperCase(),onClick:function(){a.execCommand("mceToggleFormat",!1,b)},onPostRender:function(){var c=this,d=function(){a.formatter.formatChanged(b,function(a){c.active(a)})};a.formatter?d():a.on("init",d)}})})});var b="paste, formatoptions, wordpress, wplink",e="bold italic style-h3 | strikethrough | link unlink";window.pmcGalleryV3AdminGallery.pmcStoreProductsEnabled&&(b+=", pmcstoreproducts",e+=" | pmcstoreproducts"),window.pmcGalleryV3AdminGallery.pmcBuyNowEnabled&&(b+=", pmc_buy_now_button",e+=" | pmc_buy_now_button"),tinyMCE.init({selector:d,theme:"modern",inline:c,plugins:b,width:"100%",resize:!0,statusbar:!0,menubar:!1,toolbar1:e,paste_as_text:!0,setup:function(b){b.on("change",function(){b.save()}),b.on("blur",function(){a(this.targetElm).change()});try{!b.wp&&tinyMCE.editors&&tinyMCE.editors[0]&&tinyMCE.editors[0].wp?b.wp=tinyMCE.editors[0].wp:b.wp||(b.wp={_createToolbar:function(){return{on:function(){}}}})}catch(c){console&&console.error&&console.error("Something went wrong!")}}})},100)}};window.PmcGalleryAdminScript=b}(jQuery),function(a,b){"use strict";a(document).ready(function(){var a=window.pmc||{},c=b.view.Attachment.Details.TwoColumn;a.view=a.view||{},a.view.AttachmentDetailsTwoColumn=c.extend({save:function(a,b){var c=this.getUTCStamp(new Date),d={modified_gmt:c};if(d[a]=b,this.options.bulkEdit){var e=this.controller.state().frame.options.selection.models,f=this.model.get("id");e.forEach(function(a){f!==a.get("id")&&a.set(d,{silent:!0})})}this.model.set(d)},getUTCStamp:function(a){var b=a.getUTCDate(),c=a.getUTCMonth(),d=a.getUTCFullYear(),e=a.getUTCMinutes(),f=a.getUTCHours(),g=a.getUTCSeconds();return c+=1,1===c.toString().length&&(c="0"+c),1===b.toString().length&&(b="0"+b),1===f.toString().length&&(f="0"+f),1===e.toString().length&&(e="0"+e),1===g.toString().length&&(g="0"+g),d+"-"+c+"-"+b+" "+f+":"+e+":"+g}}),_.extend(window.pmc,a)})}(jQuery,wp.media),function(a,b){"use strict";a(document).ready(function(){var c=window.pmc||{},d=b.view.AttachmentCompat;c.view=c.view||{},c.view.AttachmentCompat=d.extend({render:function(){return d.prototype.render.apply(this,arguments),a(".compat-field-image_credit input",this.$el).attr("data-setting","image_credit").val(this.model.get("image_credit")),this},save:function(){}}),_.extend(window.pmc,c)})}(jQuery,wp.media),function(a,b){"use strict";a(document).ready(function(){var a=window.pmc||{},c=b.view.Attachment;a.view=a.view||{},a.view.Attachment=c.extend({initialize:function(){var a=this.controller.content.mode();switch(a){case"gallery_edit":this.buttons={close:!0,check:!0};break;default:this.buttons={check:!0}}c.prototype.initialize.apply(this,arguments)},events:function(){return _.extend({},c.prototype.events,{"dblclick .js--select-attachment":"openModal","click .close":"removeFromLibrary"})},render:function(){c.prototype.render.apply(this,arguments)},openModal:function(){var b,c,d=this.controller.content.mode(),e=this.controller.state();return"gallery_edit"===d&&(e=this.controller.state("gallery-edit"),c=e.get("selection")),b=void 0!==c&&1<c.length?new a.view.BulkEditAttachments({frame:"edit-attachments",controller:this.controller,library:e.get("library"),selection:e.get("selection"),model:this.model}):new a.view.EditAttachments({frame:"edit-attachments",controller:this.controller,library:e.get("library"),model:this.model})},removeFromLibrary:function(){c.prototype.removeFromLibrary.apply(this,arguments);var a=this.controller,d=a.state("gallery-edit"),e=d.get("selection"),f=this.model.get("attachment_id"),g=a.state("gallery-library").get("library"),h=b.model.Attachment.get(f);e.remove(this.model),h.fetch(),"undefined"!=typeof h.get("id")&&g.add(h),d.get("library").trigger("bulk:remove",[h])},updateSetting:function(){c.prototype.updateSetting.apply(this,arguments),window.PmcGalleryAdminScript.BindMetaBoxCaptionTinyMce()},save:function(a,b){var d=this.controller.content.mode();"gallery_edit"===d?this.model.set(a,b):c.prototype.save.apply(this,arguments)}}),_.extend(window.pmc,a)})}(jQuery,wp.media),function(a,b){"use strict";a(document).ready(function(){var c=window.pmc||{},d=b.view.MediaFrame.EditAttachments;c.view=c.view||{},c.view.EditAttachments=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments)},createModal:function(){this.controller.trigger("edit-attachments:open",this),d.prototype.createModal.apply(this,arguments),this.attachIndexToHeader(),this.enableToolTips(),window.PmcGalleryAdminScript.BindMetaBoxCaptionTinyMce(),this.modal.on("close",_.bind(function(){this.modal.$el.remove(),this.controller.trigger("edit-attachments:close",this)},this))},editMetadataMode:function(a){var d=this.controller.content.mode();"gallery_edit"===d?a.view=new c.view.AttachmentDetailsTwoColumn({controller:this,model:this.model}):a.view=new b.view.Attachment.Details.TwoColumn({controller:this,model:this.model}),"gallery_edit"!==d&&isNaN(parseInt(this.model.get("gallery_id"),0))?a.view.views.set(".attachment-compat",new b.view.AttachmentCompat({controller:this,model:this.model})):a.view.views.set(".attachment-compat",new c.view.AttachmentCompat({controller:this,model:this.model}))},rerender:function(){d.prototype.rerender.apply(this,arguments),this.attachIndexToHeader(),this.enableToolTips(),window.PmcGalleryAdminScript.BindMetaBoxCaptionTinyMce()},resetRoute:function(){},attachIndexToHeader:function(){var b=a('<span class="current-attachment-number"></span>'),c=this.$(".edit-media-header").find(".current-attachment-number"),e=d.prototype.getCurrentIndex.apply(this,arguments)+1,f=e+"/"+this.library.length;c.length?a(c).text(f):(a(b).text(f),a(b).prependTo(".edit-media-header"))},enableToolTips:function(){this.$(".imgedit-help-toggle").tooltip({position:{my:"right bottom-20",at:"right top",using:function(b,c){a(this).css(b),a("<div>").addClass("arrow").addClass(c.vertical).addClass(c.horizontal).appendTo(this)}}})},keyEvent:function(a){("INPUT"!==a.target.nodeName&&"TEXTAREA"!==a.target.nodeName||a.target.readOnly||a.target.disabled)&&(39===a.keyCode&&this.nextMediaItem(a),37===a.keyCode&&this.previousMediaItem(a))},previousMediaItem:function(a){d.prototype.previousMediaItem.apply(this,arguments),this.library.trigger("edit:attachments:move:previous",a,this)},nextMediaItem:function(a){d.prototype.nextMediaItem.apply(this,arguments),this.library.trigger("edit:attachments:move:next",a,this)}}),c.view.BulkEditAttachments=c.view.EditAttachments.extend({initialize:function(){c.view.EditAttachments.prototype.initialize.apply(this,arguments)},createModal:function(){c.view.EditAttachments.prototype.createModal.apply(this,arguments),this.$el.addClass("bulk-edit-frame"),this.removeHeader()},editMetadataMode:function(a){var d=this.controller.content.mode(),e=this.controller.state("gallery-edit"),f=e.get("selection"),g=[];!1!==f.multiple&&(f.models.forEach(function(a,b){g[b]=a.id}),a.view=new c.view.AttachmentDetailsTwoColumn({controller:this,model:this.model,bulkEdit:!0,modelIds:g})),"gallery_edit"!==d&&isNaN(parseInt(this.model.get("gallery_id"),0))?a.view.views.set(".attachment-compat",new b.view.AttachmentCompat({controller:this,model:this.model})):a.view.views.set(".attachment-compat",new c.view.AttachmentCompat({controller:this,model:this.model}))},rerender:function(){c.view.EditAttachments.prototype.rerender.apply(this,arguments),this.removeHeader()},resetRoute:function(){},isBulkEdit:function(){var a=this.controller.state("gallery-edit"),b=a.get("selection");return!1!==b.multiple||b.multiple},removeHeader:function(){this.isBulkEdit()&&this.$(".edit-media-header").remove()},previousMediaItem:function(){},nextMediaItem:function(){}}),_.extend(window.pmc,c)})}(jQuery,wp.media),function(a,b){"use strict";a(document).ready(function(){var a=window.pmc||{},c=b.view.l10n;a.view=a.view||{},a.view.selectionAll=b.View.extend({tagName:"div",className:"media-selection select-all",template:_.template('<div class="selection-info"><button type="button" class="button-link select-all">'+c.selectAll+"</button></div>"),events:{"click .select-all":"selectAll"},initialize:function(a){this.state=a.state,this.library=this.state.get("library"),this.selection=this.state.get("selection"),this.selection.on("add remove reset",this.refresh,this),this.controller.on("content:activate",this.refresh,this)},selectAll:function(a){a.preventDefault(),this.selection.reset(this.library.toArray())},ready:function(){this.refresh()},refresh:function(){0<this.selection.length?this.$el.addClass("empty"):this.$el.removeClass("empty")}}),_.extend(window.pmc,a)})}(jQuery,wp.media),function(a,b){"use strict";a(document).ready(function(){var c=window.pmc||{},d=b.view.l10n,e=b.view.MediaFrame.Post;c.Post=e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments),this.on("content:create:gallery_edit",this.galleryEditContent,this),this.on("content:deactivate:gallery_edit",this.galleryEditDeactivated,this),this.on("content:activate",this.galleryAddToolbar,this)},galleryMenu:function(){},browseRouter:function(a){e.prototype.browseRouter.apply(this,arguments),a.set({gallery_edit:{text:d.editGalleryTitle,priority:50}})},browseContent:function(a){var b=this.state();b.set("AttachmentView",c.view.Attachment),this.$el.removeClass("hide-toolbar"),a.view=new wp.media.view.AttachmentsBrowser({controller:this,collection:b.get("library"),selection:b.get("selection"),model:b,sidebar:!1,sortable:b.get("sortable"),search:b.get("searchable"),filters:b.get("filterable"),date:b.get("date"),display:b.has("display")?b.get("display"):b.get("displaySettings"),dragInfo:b.get("dragInfo"),idealColumnWidth:b.get("idealColumnWidth"),suggestedWidth:b.get("suggestedWidth"),suggestedHeight:b.get("suggestedHeight"),AttachmentView:b.get("AttachmentView")}),this.selectionStatusToolbar(a.view.toolbar)},galleryEditContent:function(){var b,e=this.state("gallery-edit"),f=e.get("library"),g=e.get("selection");this.$el.removeClass("hide-toolbar"),g.multiple="add",this.$el.addClass("gallery-edit"),b=new wp.media.view.AttachmentsBrowser({controller:this,collection:f,selection:g,model:e,sidebar:!1,display:!0,dragInfo:e.get("dragInfo"),search:e.get("searchable"),filters:e.get("filterable"),date:e.get("date"),describe:!0,AttachmentView:c.view.Attachment,sortable:{start:function(a,b){b.item.data("sortableIndexStart",b.item.index())},helper:function(b,c){if(!g.length||!c.hasClass("selected"))return c;var d=c.parent().children(".selected").clone(),e=a("<li></li>");return c.data("multidrag",d).siblings(".selected").addClass("hidden"),d.css({width:c.outerWidth(),height:c.outerHeight()}).addClass("helper"),e.css({width:c.outerWidth()*d.length,height:c.outerHeight()}),e.append(d),e},stop:function(a,b){b.item.siblings(".selected").removeClass("hidden")},update:function(a,b){var c=f,d=c.at(b.item.data("sortableIndexStart")),e=c.comparator,h=b.item.index();delete c.comparator,g.length&&b.item.hasClass("selected")?(g.each(function(a){c.remove(a)}),g.each(function(a,b){c.add(a,{at:h+b})})):(c.remove(d,{silent:!0}),c.add(d,{silent:!0,at:b.item.index()})),c.comparator=e,c.trigger("reset",c),c.trigger("reset:order",c),c.saveMenuOrder()}}}),b.toolbar.set("selectall",new c.view.selectionAll({controller:this,state:e,priority:-40})),b.toolbar.set("selection",new wp.media.view.Selection({controller:this,collection:e.get("selection"),priority:-40,editable:e.get("editable")&&function(){this.controller.content.mode("edit-selection")}})),b.toolbar.set("reverse",{text:d.reverseOrder,priority:80,click:function(){f.reset(f.toArray().reverse()),f.trigger("reset:order",f)}}),b.toolbar.set("sortNumerically",{text:d.sortNumerically,priority:80,click:function(){var a=f.toArray().sort(function(a,b){return a.get("attachment_id")-b.get("attachment_id")});f.reset(a),f.trigger("reset:order",f)}}),b.toolbar.set("sortAlphabetically",{text:d.sortAlphabetically,priority:80,click:function(){var a=f.toArray().sort(function(a,b){var c=a.get("filename").replace(new RegExp("-","g"),""),d=b.get("filename").replace(new RegExp("-","g"),"");return c>d});f.reset(a),f.trigger("reset:order",f)}}),b.toolbar.set("sortCreatedDate",{text:d.sortCreatedDate,priority:80,click:function(){var a=f.toArray().sort(function(a,b){var c=a.get("attachment_created_timestamp"),d=b.get("attachment_created_timestamp");return c>d});f.reset(a),f.trigger("reset:order",f)}}),b.toolbar.set("editmetadata",{text:d.editmetadata,priority:-70,click:function(){0<g.length&&a("li.selected .js--select-attachment",b.attachments.$el).first().trigger("dblclick")}}),b.toolbar.set("sendToFront",{text:"Send to front",priority:-60,click:function(){g.each(function(a,b){f.remove(a),f.add(a,{at:b})}),f.trigger("reset:order",f)}}),b.toolbar.set("sendToBack",{text:"Send to back",priority:-60,click:function(){g.each(function(a){f.remove(a),f.add(a)}),f.trigger("reset:order",f)}}),b.toolbar.set("bulkRemove",{text:d.remove,priority:-70,click:function(){var a=g.models;g.each(function(a){f.remove(a)}),g.reset(),f.trigger("bulk:remove",a)}}),f.observe(wp.Uploader.queue),this.content.set(b)},removeGallerySelection:function(){var a=this.state("gallery-edit"),b=a.get("selection");b.reset()},galleryEditDeactivated:function(){var a=this.state("gallery-edit"),b=a.get("library");this.$el.removeClass("gallery-edit"),b.unobserve(wp.Uploader.queue)},galleryAddToolbar:function(){var a=this.content.mode(),b=d.addToGallery,c={selection:!0};"gallery_edit"===a&&(b=d.updateGallery,c={}),this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:b,priority:80,requires:c,click:function(){var b,c,d,e,f,g=this.controller,h=[];"gallery_edit"===a?(b=g.state("gallery-edit"),b.trigger("update",b.get("library")),g.setState(g.options.state),g.reset()):(b=g.state(),c=g.state("gallery-edit"),e=b.get("selection"),f="undefined"!=typeof pmc_gallery_admin_options&&"prepend"===pmc_gallery_admin_options.add_gallery,e.each(function(a){-1!==_.indexOf(h,parseInt(a.get("attachment_id"),0))?e.remove(a):h.push(parseInt(a.get("attachment_id"),0))}),d=e.models,f?c.get("library").add(d,{at:0}):c.get("library").add(d),b.trigger("reset"),c.get("library").trigger("bulk:add",d,f),g.content.mode("gallery_edit"))}}}}))}}),_.extend(c.Post,e),_.extend(window.pmc,c)})}(jQuery,wp.media),function(a){"use strict";a(document).ready(function(){var b=window.pmc||{};b.GoogleAnalyticEvents=Backbone.View.extend({initialize:function(b){var c=this;this.location=window.location.href,"undefined"!=typeof pmc_gallery_admin_user&&(this.user=pmc_gallery_admin_user.user_login),this.mediaFrame=b.mediaFrame,this.mediaFrame.on("update",this.save,this),a("#publish, #save-post").click(function(a){c.save(a)}),this.mediaFrame.state("gallery-edit").get("library").on("change",this.onMetaChange,this),this.mediaFrame.state("gallery-library").get("library").on("change",this.onMetaChange,this),this.mediaFrame.state("gallery-edit").get("library").on("edit:attachments:move:next",this.editAttachmentMoveNext,this),this.mediaFrame.state("gallery-edit").get("library").on("edit:attachments:move:previous",this.editAttachmentMovePrevious,this),this.mediaFrame.state("gallery-library").get("library").on("edit:attachments:move:next",this.editAttachmentMoveNext,this),this.mediaFrame.state("gallery-library").get("library").on("edit:attachments:move:previous",this.editAttachmentMovePrevious,this),this.mediaFrame.on("edit-attachments:open",this.editAttachmentOpen,this)},events:{"keyup #media-search-input":"search","change #media-search-input":"search","search #media-search-input":"search","click .search-form .media-button-reverse":"reverse_order","click .search-form .media-button-sortNumerically":"sort_number","click .search-form .media-button-sortAlphabetically":"sort_A_Z","click .search-form .media-button-sortCreatedDate":"sort_created_date","click .media-button-sendToFront":"send_to_front","click .media-button-sendToBack":"send_to_back"},onMetaChange:function(b){if("undefined"==typeof b)return!1;var c=this.mediaFrame.content.mode(),d="single";"gallery_edit"===c&&1<this.mediaFrame.state("gallery-edit").get("selection").length&&(d="bulk");var e,f,g=Object.keys(b.changed).pop(),h="edit",i=b.changed[g];switch(""===b._previousAttributes[g]&&(h="add"),g){case"compat":f="image_credit_"+d,i=a(".compat-field-image_credit input",b.changed.compat.item).val();break;case"alt":f="image_alt_text_"+d;break;case"image_credit":f="image_credit_"+d;break;default:f="image_"+g+"_"+d}e={eventCategory:f,eventAction:h,eventLabel:this.user+"_"+this.location+"_"+i},this.push(e)},search:function(a){var b={eventCategory:"search",eventAction:"perform",eventLabel:this.user+"_"+this.location+"_"+a.target.value};this.push(b)},save:function(a){var b=!1;"undefined"!=typeof a.target?(b=a.target.value,b=b.toLowerCase(),"save draft"===b&&(b="save")):b="update";var c={eventCategory:"content",eventAction:b,eventLabel:this.user+"_"+this.location};this.push(c)},reverse_order:function(a){this.sort(a,"reverse_order")},sort_number:function(a){this.sort(a,"sort_number")},sort_A_Z:function(a){this.sort(a,"sort_A_Z")},sort_created_date:function(a){this.sort(a,"sort_created_date")},sort:function(a,b){var c={eventCategory:b,eventAction:a.type,eventLabel:this.user+"_"+this.location};this.push(c)},send_to_front:function(a){var b={eventCategory:"send_to_front",eventAction:a.type,eventLabel:this.user+"_"+this.location};this.push(b)},send_to_back:function(a){var b={eventCategory:"send_to_back",eventAction:a.type,eventLabel:this.user+"_"+this.location};this.push(b)},editAttachmentMoveNext:function(a){var b={eventCategory:"next_image",eventAction:a.type,eventLabel:this.user+"_"+this.location};this.push(b)},editAttachmentMovePrevious:function(a){var b={eventCategory:"prev_image",eventAction:a.type,eventLabel:this.user+"_"+this.location};this.push(b)},editAttachmentOpen:function(a){var b,c,d=a.controller.state("gallery-edit").get("selection");c=1<d.length?"bulk_image_edit":"single_image_edit",b={eventCategory:c,eventAction:"view",eventLabel:this.user+"_"+this.location},this.push(b)},push:function(a){"function"==typeof ga&&ga("send","event",a)}})})}(jQuery),function(a){"use strict";a(document).ready(function(){a(this).on("click","#TB_closeWindowButton",function(){"function"==typeof tb_remove&&tb_remove()}),wp.media.pmc_gallery={editGalleryLibreryCache:{},frame:function(){var b,c,d=this;return this._frame?this._frame:(this._frame=new window.pmc.Post({id:"pmc-gallery",frame:"post",state:"gallery-library",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:this.select()}),b=this._frame.state("gallery-edit").get("library"),c=this._frame.state("gallery-library").get("library"),this._frame.on("open",function(){d.Analytic=new window.pmc.GoogleAnalyticEvents({el:"#pmc-gallery",mediaFrame:d._frame})}),this._frame.on("edit-attachments:open",function(a){setTimeout(function(){d.validateImageCredit(a.model)},500)}),this._frame.on("update",function(){wp.media.pmc_gallery.save()}),b.on("bulk:add",function(a,b){d.bulkAddAttachment(a,b)}),b.on("bulk:remove",function(a){d.bulkRemoveAttachment(a)}),b.on("reset:order",function(a){d.reorderAttachment(a)}),this._frame.on("edit-attachments:close",this.edit_attachment_close,this),b.on("change",this.onChangeAttachment),c.on("change",this.onChangeAttachmentFromMediaLibrary),c.on("remove",this.onRemoveAttachmentFromMediaLibrary),c.on("edit:attachments:move:next edit:attachments:move:previous",function(b,c){a(".mce-toolbar-grp").css("display","none"),"undefined"!=typeof c.model.attributes.compat.item&&(c.model.set("image_credit",a(".compat-field-image_credit input",c.model.attributes.compat.item).val()),d.validateImageCredit(c.model))}),b.on("edit:attachments:move:next edit:attachments:move:previous",function(b,c){a(".mce-toolbar-grp").css("display","none"),d.validateImageCredit(c.model)}),this._frame.on("content:activate",function(){var b=d._frame.content.mode();a("#pmc-gallery .media-frame-content .media-toolbar-secondary .media-selection").prependTo("#pmc-gallery > .media-frame-toolbar .media-toolbar-secondary"),"gallery_edit"!==b&&(d.editGalleryLibreryCache=d._frame.state("gallery-edit").get("library").toJSON())}),this._frame)},edit_attachment_close:function(){var a=this._frame.content.mode(),b=this._frame.state("gallery-edit"),c=b.get("selection");"gallery_edit"===a&&c.reset()},bulkAddAttachment:function(b,c){var d,e,f={sub_action:"add",is_prepend:c?1:0},g={};for(e in b)b[e].set("gallery_id",wp.media.view.settings.post.id,{silent:!0}),"undefined"!=typeof b[e].attributes.compat.item&&b[e].set("image_credit",a(".compat-field-image_credit input",b[e].attributes.compat.item).val(),{silent:!0}),d=b[e].toJSON(),g[e]={id:d.attachment_id,author:d.author,title:d.title,description:d.description,caption:d.caption,alt:d.alt,pinterest_description:d.pinterest_description||"",image_credit:""};f.data=g,this._save(f)},bulkRemoveAttachment:function(a){var b,c={},d={sub_action:"remove"};for(b in a)c[b]=a[b].get("attachment_id");d.ids=c,this._save(d,this.addAttachmentVariantInMedia)},reorderAttachment:function(a){var b={sub_action:"reorder",ids:a.pluck("attachment_id")};this._save(b)},onChangeAttachment:function(b){var c,d,e,f,g=wp.media.pmc_gallery,h=wp.media.pmc_gallery._frame.states.get("gallery-edit"),i=g.editGalleryLibreryCache,j=h.get("selection"),k="undefined"!=typeof pmc_gallery_admin_options&&"prepend"===pmc_gallery_admin_options.add_gallery,l=1<j.length?j.pluck("attachment_id"):[b.get("attachment_id")],m={},n=g._frame.content.mode(),o=a(".attachment-details .settings-save-status"),p=a(".spinner",o),q=a(".saved",o);if("undefined"!=typeof b.get("uploading")&&!0===b.get("uploading"))return!1;if("undefined"!=typeof b.changed.id||"gallery_edit"!==n){c=g._frame.state("gallery-edit").get("library");for(d in i)e=i[d].id,m[e]={title:i[d].title,description:i[d].description,caption:i[d].caption,alt:i[d].alt,pinterest_description:i[d].pinterest_description||"",image_credit:i[d].image_credit};return c.each(function(a){e=a.get("id");for(d in m[e])a.set(d,m[e][d],{silent:!0})}),-1===_.indexOf(_.pluck(i,"attachment_id"),parseInt(b.get("attachment_id"),0))&&c.trigger("bulk:add",[b],k),!1}return g.validateImageCredit(b),f={sub_action:"edit",ids:l,changes:b.changed},p.css({visibility:"visible"}),g._save(f,function(){p.css({visibility:"hidden"}),q.show(),setTimeout(function(){q.hide()},2e3)}),!0},addAttachmentVariantInMedia:function(a){var b,c,d=wp.media.pmc_gallery,e=d._frame.state("gallery-library"),f=e.get("library");for(b in a)c=new Backbone.Model(a[b]),f.add(c);e.reset()},onRemoveAttachmentFromMediaLibrary:function(a){var b=wp.media.pmc_gallery,c=b._frame.state("gallery-library"),d=c.get("library"),e=parseInt(a.get("attachment_id"),0);d.each(function(a){"undefined"!=typeof a&&parseInt(a.get("attachment_id"),0)===e&&d.remove(a,{silent:!0})})},onChangeAttachmentFromMediaLibrary:function(b,c){var d=b.get("gallery_id"),e=wp.media.pmc_gallery;d?c.data=_.extend(c.data||{},{attachment_id:b.get("attachment_id"),gallery_id:b.get("gallery_id")}):c.data=_.extend(c.data||{},{attachment_id:b.get("attachment_id")}),"undefined"!=typeof b.attributes.compat.item&&(b.set("image_credit",a(".compat-field-image_credit input",b.attributes.compat.item).val()),e.validateImageCredit(b))},removeGalleryFromLibrary:function(){var a=this._frame.state("gallery-edit"),b=a.get("library"),c=this._frame.state("gallery-library").get("library"),d=b.pluck("attachment_id");c.each(function(a){"undefined"!=typeof a&&-1!==_.indexOf(d,a.get("attachment_id"))&&c.remove(a,{silent:!0})})},save:function(){var a,b,c=wp.media.pmc_gallery._frame.states.get("gallery-edit"),d=c.get("library"),e=d.pluck("attachment_id"),f=d.toJSON(),g={};for(b in f)g[b]={id:f[b].attachment_id,title:f[b].title,description:f[b].description,caption:f[b].caption,alt:f[b].alt,pinterest_description:f[b].pinterest_description||"",image_credit:f[b].image_credit};a={sub_action:"update",data:g,ids:e},this._save(a)},_save:function(b,c){var d=a(".media-modal .spinner"),e=_.extend(b||{},{nonce:wp.media.view.settings.post.nonce,html:wp.media.pmc_gallery.link,post_id:wp.media.view.settings.post.id,security:pmc_gallery_admin_options.pmc_gallery_update});d.css("visibility","visible"),wp.media.post("pmc_gallery_update",e).done(function(a){d.css("visibility","hidden"),"function"==typeof c&&c(a)}).fail(function(){d.css("visibility","hidden")})},createToolBar:function(a){a.options.search||(wp.media.pmc_gallery.renderSortButton(a,"sortNumerically",wp.media.view.l10n.sortNumerically,1),wp.media.pmc_gallery.renderSortButton(a,"sortAlphabetically",wp.media.view.l10n.sortAlphabetically,2))},init:function(){var b=a("#title");this.frame().open(),a("#__wp-uploader-id-1").prependTo("#pmc-gallery-images"),a("#pmc-gallery .media-frame-content .media-toolbar-secondary .media-selection").prependTo("#pmc-gallery > .media-frame-toolbar .media-toolbar-secondary"),a("body").removeClass("modal-open"),this._frame.content.mode("browse"),a("html, body").animate({scrollTop:0},"fast"),0===b.val().length&&b.focus()},select:function(){var b,c,d,e,f=this,g={sub_action:"get",nonce:wp.media.view.settings.post.nonce,post_id:wp.media.view.settings.post.id,security:pmc_gallery_admin_options.pmc_gallery_update};try{c=wp.media.gallery.defaults.id,b=wp.shortcode.next("gallery",wp.media.view.settings.pmc_gallery.shortcode)}catch(h){b=!1}return!!b&&(b=b.shortcode,_.isUndefined(b.get("id"))&&!_.isUndefined(c)&&b.set("id",c),d=wp.media.gallery.attachments(b),e=new wp.media.model.Selection(d.models,{props:d.props.toJSON(),multiple:!0}),e.gallery=d.gallery,e.more().done(function(){e.props.set({query:!1}),e.unmirror(),e.props.unset("orderby"),e.on("add",f.addAttachment),0<e.length&&f._frame.content.mode("gallery_edit"),wp.media.post("pmc_gallery_update",g).done(function(b){var c,d,g,h={},i=e.toJSON();if(0===b.length){f.save();for(c in i)e.models[c].set("image_credit",a(".compat-field-image_credit input",e.models[c].attributes.compat.item).val(),{silent:!0});return!1}for(c in b)h[b[c].id]=b[c];e.off("change",f.onChangeAttachment);for(c in i){g=i[c].id;for(d in h[g])e.models[c].set(d,h[g][d],{silent:!0})}e.on("change",f.onChangeAttachment)}).fail(function(){})}),e)},validateImageCredit:function(b){var c,d=a("form.compat-item .compat-field-image_credit input"),e=a(".attachment-details .settings-save-status"),f=a(".required",e);"undefined"==typeof d||0>=d.length||"undefined"==typeof b||(c=b.get("image_credit"),c="undefined"!=typeof c?c:"",d.removeClass("error"),0>=c.length?(d.addClass("error"),f.show()):(d.removeClass("error"),f.hide()))}},wp.media.pmc_gallery.init();var b=wp.media.featuredImage.frame();b.on("open",function(){var a=wp.media.pmc_gallery._frame.content.mode(),c=wp.media.pmc_gallery._frame.state("gallery-edit").get("library");"gallery_edit"===a&&(b.content.mode("browse"),c.unobserve(wp.Uploader.queue))}),b.on("close",function(){var a=wp.media.pmc_gallery._frame.content.mode(),b=wp.media.pmc_gallery._frame.state("gallery-edit").get("library");"gallery_edit"===a&&b.observe(wp.Uploader.queue)})})}(jQuery),jQuery(document).ready(function(){var a=jQuery("#enable_interstitial"),b=a.prop("checked"),c=jQuery("#interstitial_refresh_clicks, #interstitial_duration, #start_with_interstitial, #interstitial_ad_code");c.each(function(){var a=jQuery(this);b?a.closest("tr").css("display","table-row"):a.closest("tr").css("display","none")}),a.change(function(){var b=a.prop("checked");c.each(function(){var a=jQuery(this);b?a.closest("tr").css("display","table-row"):a.closest("tr").css("display","none")})})});