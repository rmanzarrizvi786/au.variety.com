(function(){!function(a){var b;return b=function(){function b(){return this.currentTime=0,this.lockPeriod=1e3*adminPageLockingData.lockPeriod,this.lockPeriodMax=1e3*adminPageLockingData.lockPeriodMax,a("#apl-user").length?(alert(a("#apl-lock-error p").text().trim()),void this.exitScreen()):(a(window).on("beforeunload",function(a){return function(){a.releaseLock()}}(this)),a(document).on("click",".apl-confirm-button",function(b){return function(b){return tb_remove(),a(document).trigger("apl-confirm",[a(b.target).data("confirm")])}}(this)),this.updateLock(),void(this.lockPeriodMax&&this.setMaxTimer()))}return b.prototype.updateLock=function(){return this.currentTime+=this.lockPeriod,0===this.lockPeriodMax||this.currentTime<this.lockPeriodMax?(a.post(adminPageLockingData.ajaxUrl,{action:adminPageLockingData.actionUpdateLock},function(a){return a.success?void 0:(alert(a.data.message),location.reload())}),this.setLockTimer()):void 0},b.prototype.releaseLock=function(){return a.post(adminPageLockingData.ajaxUrl,{action:adminPageLockingData.actionReleaseLock})},b.prototype.askForMoreTime=function(){var b,c,d;return c=setTimeout(function(a){return function(){return alert(adminPageLockingData.errorLockMax),a.exitScreen()}}(this),this.lockPeriod),d=function(b){return function(e,f){return a(document).off("apl-confirm",d),"yes"===f?(b.currentTime=0,b.setMaxTimer(),b.setLockTimer()):(clearTimeout(c),b.exitScreen())}}(this),a(document).on("apl-confirm",d),b=this.modalConfirm(adminPageLockingData.moreTime),-1!==b?this.respondToConfirm(null,b?"yes":"no"):void 0},b.prototype.setMaxTimer=function(){return clearTimeout(this.maxTimer),this.maxTimer=setTimeout(function(a){return function(){return a.askForMoreTime()}}(this),this.lockPeriodMax-this.lockPeriod)},b.prototype.setLockTimer=function(){return clearTimeout(this.lockTimer),this.lockTimer=setTimeout(function(a){return function(){return a.updateLock()}}(this),this.lockPeriod)},b.prototype.exitScreen=function(){return location.href=adminPageLockingData.adminUrl},b.prototype.modalConfirm=function(b){var c,d;return"undefined"!=typeof tb_show&&null!==tb_show?(a("#apl-message-content").length||a("body").append('<div id="apl-message" style="display:none;"><p id="apl-message-content"></p><p><a class="button-primary apl-confirm-button" data-confirm="yes">Yes</a>&nbsp;<a class="button-secondary apl-confirm-button" data-confirm="no">No</a></p></div>'),a("#apl-message-content").text(b),tb_show(null,"#TB_inline?inlineId=apl-message&width=300&height=200",!1),c=a("#TB_overlay"),d=a("#TB_closeWindowButton"),"undefined"!=typeof c&&c.on("click",function(b){a(document).trigger("apl-confirm",["yes"])}),"undefined"!=typeof d&&d.on("click",function(b){a(document).trigger("apl-confirm",["yes"])}),-1):confirm(b)},b}(),a(function(){return new b})}(jQuery)}).call(this);