!function(){"use strict";var e={n:function(t){var l=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(l,{a:l}),l},d:function(t,l){for(var r in l)e.o(l,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:l[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.blocks,l=window.wp.i18n,r=window.wp.element,a=window.wp.apiFetch,n=e.n(a),o=window.wp.components,c=window.wp.htmlEntities,i=window.wp.url;const u=({items:e,curationTaxonomy:t,currentStyleName:a})=>{const n=({title:e,url:t,image:l})=>(0,r.createElement)("div",{className:"lrv-u-background-color-white lrv-u-padding-a-050 lrv-u-height-100p"},(0,r.createElement)("div",{className:"lrv-a-crop-16x9"},(0,r.createElement)("img",{className:"lrv-a-crop-img",src:l,alt:""})),(0,r.createElement)("span",{className:"lrv-u-font-size-16 lrv-u-font-family-basic lrv-u-font-weight-bold lrv-u-line-height-small lrv-u-margin-tb-050 lrv-u-display-block"},(0,r.createElement)("a",{href:t},e))),o=({title:e,url:t,image:l})=>(0,r.createElement)("div",{className:"lrv-u-height-100p"},(0,r.createElement)("div",{className:"lrv-a-crop-16x9"},(0,r.createElement)("img",{className:"lrv-a-crop-img",src:l,alt:""})),(0,r.createElement)("span",{className:"lrv-u-font-size-16 lrv-u-font-family-basic lrv-u-font-weight-bold lrv-u-line-height-small lrv-u-margin-tb-050 lrv-u-display-block"},(0,r.createElement)("a",{href:t},e))),i=({title:e,url:t,image:a})=>(0,r.createElement)("div",{className:"lrv-u-background-color-grey-lightest lrv-u-padding-a-050 lrv-a-glue-parent lrv-u-height-100p"},(0,r.createElement)("div",{className:"lrv-a-crop-16x9"},(0,r.createElement)("img",{className:"lrv-a-crop-img",src:a,alt:""}),(0,r.createElement)("span",{style:{zIndex:0},className:"lrv-u-text-transform-uppercase lrv-a-glue lrv-a-glue--t-0 lrv-a-glue--r-0 lrv-u-padding-a-025 lrv-u-font-size-14 lrv-u-font-weight-bold lrv-u-background-color-grey-darkest lrv-u-color-white"},(0,l.__)("Video","pmc-gutenberg"))),(0,r.createElement)("span",{className:"lrv-u-font-size-16 lrv-u-font-family-basic lrv-u-font-weight-bold lrv-u-line-height-small lrv-u-margin-tb-050 lrv-u-display-block"},(0,r.createElement)("a",{href:t},e))),u=({title:e,excerpt:l,url:c,image:u})=>{const s=null==a?void 0:a.includes("gallery"),m="vcategory"===t&&!s,g=!s&&!m;return(0,r.createElement)(r.Fragment,null,s&&(0,r.createElement)(o,{title:e,url:c,image:u}),m&&(0,r.createElement)(i,{title:e,url:c,image:u}),g&&(0,r.createElement)(n,{url:c,title:e,excerpt:l,image:u}))};return e.map((({title:e,excerpt:t,url:l,image:a})=>(0,r.createElement)(u,{key:e,title:(0,c.decodeEntities)(e),url:l,excerpt:null!=t?t:"",image:a})))};var s=({termId:e,curationTaxonomy:t,className:a,blockStyles:s})=>{const[m,g]=(0,r.useState)(!0),[p,d]=(0,r.useState)(!1),[v,b]=(0,r.useState)([]),y=s.filter((({name:e})=>null==a?void 0:a.includes(e)))[0];return(0,r.useEffect)((()=>{(()=>{var l;const r="vcategory"===t,a=window.pmc_gutenberg_blocks_config[`pmc_${"pmc/carousel".split("/")[1].replace(/-/g,"_")}_block_config`],o=null!==(l=a.video&&a.video.post_type)&&void 0!==l?l:"pmc_top_video";let u;var s,m;u=r?(0,i.addQueryArgs)(`/wp/v2/${o}`,{vcategory:e,per_page:null==y||null===(s=y.meta)||void 0===s?void 0:s.perPage}):(0,i.addQueryArgs)(`/pmc/carousel/v1/carousel/${e}`,{per_page:(null==y||null===(m=y.meta)||void 0===m?void 0:m.perPage)||4}),n()({path:u}).then((e=>{const t=Object.keys(e).map((t=>r?(e=>{const{id:t,link:l,title:{rendered:r},featured_image:a}=e;return{id:t,title:(0,c.decodeEntities)(r),url:l,image:a}})(e[t]):e[t]));g(!1),b(t)})).catch((e=>{console.error(e),g(!1),d(!0)}))})()}),[]),(0,r.createElement)(r.Fragment,null,m&&(0,r.createElement)(o.Spinner,null),p&&(0,r.createElement)("p",null,(0,l.__)("Error loading content.","pmc-gutenberg")),!m&&!p&&Boolean(v.length)&&(0,r.createElement)("div",{className:`lrv-a-grid lrv-a-cols3 lrv-a-cols4@desktop lrv-a-glue-parent lrv-u-background-color-grey-lightest lrv-u-padding-a-050 ${a}`},a&&(0,r.createElement)("div",{className:"lrv-u-padding-tb-050 lrv-u-padding-lr-1 lrv-u-background-color-brand-primary lrv-u-color-white lrv-a-glue lrv-a-glue--t-0 lrv-a-glue--l-0 lrv-a-font-secondary-xs"},(0,l.__)("Carousel Style: ","pmc-gutenberg")+(null==y?void 0:y.label)),(0,r.createElement)(u,{items:v,curationTaxonomy:t,currentStyleName:null==y?void 0:y.name})),!m&&!Boolean(v.length)&&(0,r.createElement)("p",null,(0,l.__)("No items to display.","pmc-gutenberg")))},m=(0,window.wp.data.withSelect)(((e,{taxonomy:t})=>{var l;const{getEntityRecords:r,hasFinishedResolution:a,getTaxonomy:n}=e("core"),o={per_page:100},c=r("taxonomy",t,o),i=a("getEntityRecords",["taxonomy",t,o]),u=n(t);return{terms:c,taxonomyNicename:null!==(l=null==u?void 0:u.labels.singular_name)&&void 0!==l?l:t,isFinished:i}}))((({terms:e,taxonomyNicename:t,onChange:a,isFinished:n})=>{const c=(()=>{let r=[{label:(0,l.sprintf)(
/* translators: 1. Taxonomy nice name. */
(0,l.__)("Select %1$s","pmc-gutenberg"),t)}];return n&&(r=[...r,...e.map((e=>{const{name:t,id:l}=e;return{label:t,value:l}}))]),r})();return(0,r.createElement)(r.Fragment,null,!n&&(0,r.createElement)(o.Spinner,null),n&&(0,r.createElement)(o.SelectControl,{label:t,help:(0,l.__)("Once you select a term, you will see a preview of the content. If you need to change the term selected, create a new block.","pmc-gutenberg"),value:(0,l.__)("Choose term.","pmc-gutenberg"),onChange:a,options:c}))}));const g=({setAttributes:e,curationTaxonomy:t})=>{const[a,c]=(0,r.useState)([]);return(0,r.useEffect)((()=>{n()({path:"/pmc/gutenberg/v1/carousel-taxonomies"}).then((e=>c(e))).catch((()=>c([{label:(0,l.__)("Select curation","pmc-gutenberg"),value:null}])))}),[]),a.length?(0,r.createElement)(o.Placeholder,{icon:"buddicons-activity",label:(0,l.__)("PMC Carousel Setup","pmc-gutenberg"),instructions:(0,l.__)("Select curation.","pmc-gutenberg"),isColumnLayout:!0},(0,r.createElement)("div",{className:"lrv-a-grid lrv-a-cols2"},(0,r.createElement)(o.SelectControl,{label:(0,l.__)("Curation","pmc-gutenberg"),value:t,onChange:t=>{e({curationTaxonomy:t})},options:a}),Boolean(t)&&(0,r.createElement)(m,{taxonomy:t,onChange:t=>{e({termId:t})}}))):(0,r.createElement)(o.Spinner,null)},p={title:(0,l.__)("PMC Carousel","pmc-gutenberg"),description:(0,l.__)("Select curated stories that were created with PMC Carousel.","pmc-gutenberg"),category:"design",icon:"buddicons-activity",supports:{anchor:!1,html:!1},attributes:{curationTaxonomy:{type:"string",default:null},termId:{type:"string",default:null}},edit:({attributes:{curationTaxonomy:e,termId:a,className:n},isSelected:o,setAttributes:c})=>{const i=[{name:"3-up",label:(0,l.__)("3 Up","pmc-gutenberg"),isDefault:!0,meta:{perPage:3}},{name:"4-up",label:(0,l.__)("4 Up","pmc-gutenberg"),meta:{perPage:4}},{name:"gallery",label:(0,l.__)("Gallery","pmc-gutenberg"),meta:{perPage:4}},{name:"story-river",label:(0,l.__)("Story River","pmc-gutenberg"),meta:{perPage:8}}],u={name:"inline-video",label:(0,l.__)("Inline Video Player","pmc-gutenberg")};return o&&"vcategory"===e&&i.push(u),i.forEach((e=>(0,t.registerBlockStyle)("pmc/carousel",e))),o&&"vcategory"!==e&&(0,t.unregisterBlockStyle)("pmc/carousel",u.name),a?(0,r.createElement)(s,{termId:a,curationTaxonomy:e,className:n,blockStyles:i}):(0,r.createElement)(g,{curationTaxonomy:e,setAttributes:c})},save:()=>null};(0,t.registerBlockType)("pmc/carousel",p)}();