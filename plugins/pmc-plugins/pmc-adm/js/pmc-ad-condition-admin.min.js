/*
Author: PMC, Hau Vong
License: PMC proprietary.  All rights reserved.
*/
var PMC_Ad_Condition=function(t){var i=this
this.options=t,this.items=[],this.track_count=0,"undefined"==typeof this.options.parameters&&(this.options.parameters={}),this.refresh(),jQuery(document).on("click",".pmc-ad-condition-del-x",function(t){i.del_item(jQuery(this).parent().attr("id")),jQuery(this).parent().parent().remove()})}
PMC_Ad_Condition.prototype={generate_form:function(){if(0!=jQuery(this.options.form).length){var t=this
this.item_result=jQuery('<select><option value="true"></option><option value="false">not</option></select>'),this.item_list=jQuery('<select><option value="">-- condition --</option></select>'),this.item_param=jQuery("<span />"),this.item_add_button=jQuery('<input type="button" value="Add" />'),jQuery(this.options.form).empty().append(this.item_result).append(this.item_list).append("(").append(this.item_param).append(")").append(this.item_add_button)
for(f in this.options.parameters)this.item_list.append(jQuery("<option/>",{value:f}).html(f))
this.item_list.on("change",function(i){t.render_item_param(jQuery(this).val())}),this.item_add_button.on("click",function(i){var e=t.item_list.val()
if(t.options.parameters[e]){var s={name:e,result:"true"==t.item_result.val(),params:[]}
t.item_param.find('input[type="text"]').each(function(t,i){s.params.push(jQuery(i).val())}),t.add_item(s),jQuery(t.item_result).val("true"),jQuery(t.item_list).val(""),t.render_item_param("")}})}},render_item_param:function(t){if("undefined"!=typeof this.item_param&&(this.item_param.empty(),this.options.parameters[t]))for(i in this.options.parameters[t]){var e=this.options.parameters[t][i]
this.item_param.append(jQuery("<input/>",{type:"text",name:e,placeholder:e}))}},render_item:function(t){var e=""
for(i in t.params)e.length>0&&(e+=", "),e+="'"+t.params[i]+"'"
jQuery(this.options.display).append(jQuery("<li/>").append(jQuery("<div/>",{id:t.id}).html((0==t.result?'<span class="not">not</span> ':"")+'<span class="name">'+t.name+"</span>("+e+")").append('<a href="javascript:;" class="pmc-ad-condition-del-x">X</a>')))},del_item:function(t){for(var i=0;i<this.items.length&&this.items[i].id!=t;)i+=1
i<this.items.length&&this.items.splice(i,1),this.update()},add_item:function(t){for(;t.params.length>0&&""===t.params[t.params.length-1];)t.params.pop()
t.id=++this.track_count,this.items.push(t),this.render_item(t),this.update()},update:function(){jQuery(this.options.input).val(JSON.stringify(this.items))},reset:function(t){if(t instanceof Array){this.items=[],jQuery(this.options.display).empty()
for(i in t)this.add_item(t[i])}this.generate_form(),this.update()},refresh:function(){if(this.list=[],jQuery(this.options.input).length>0&&jQuery(this.options.input).val().length>0)try{var t=JSON.parse(jQuery(this.options.input).val())
t instanceof Array&&(this.list=t)}catch(t){}this.reset(this.list),this.generate_form()},register_functions:function(t){}},jQuery(document).ready(function(){var t={has_category:["category","post"],has_tag:["tag","post"],is_404:[],is_archive:[],is_author:["author"],is_category:["category"],is_home:[],is_page:["page"],is_paginated:[],is_search:[],is_single:["post"],is_singular:["post_type"],is_tag:["tag"],is_tax:["taxonomy","term"],is_vertical:["vertical"],user_location:["geocode"]}
"undefined"!=typeof pmc_ad_condition_options&&"undefined"!=typeof pmc_ad_condition_options.parameters&&(t=pmc_ad_condition_options.parameters),window.pmc_ad_condition=new PMC_Ad_Condition({input:"#pmc-adm-condition-input",display:"#pmc-adm-condition-display",form:"#pmc-adm-condition-form",parameters:t})})
